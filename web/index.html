<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>QuickFinder</title>
        <link href="https://cdn.tailwindcss.com" rel="stylesheet">
        <link
            href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700&family=Roboto:wght@400;500;700&display=swap"
            rel="stylesheet">
        <link rel="stylesheet" href="/style.css">
        <script type="text/javascript" src="/eel.js"></script>
        <script type="text/javascript">
        eel.expose(printToConsole);
        function printToConsole(message, isFile = false) {
            const log = document.getElementById('log');
            if (isFile) {
                const fileInfo = message.split(', ');
                const fileEntryHtml = `<div class="file-entry"><span class="file-name">ðŸ“‚ ${fileInfo[0]}</span><span class="file-path">${fileInfo[1]}</span></div>`;
                log.innerHTML += fileEntryHtml;
            } else {
                log.innerHTML = `<div>${message}</div>${log.innerHTML}`;
            }
        }

        function addFileToExplorer(file) {
            const fileList = document.getElementById('file-list');
            const row = fileList.insertRow();
            row.insertCell().textContent = file.name;
            row.insertCell().textContent = file.path;
            row.insertCell().textContent = file.size; // Assuming size is formatted as a string
            row.insertCell().textContent = file.last_modified; // Assuming date is formatted
        }     

        eel.expose(updateIndex);
        function updateIndex() {
            eel.update_index();
        }
        
        async function processFiles() {
            let path = document.getElementById('path').value;
            let pattern = document.getElementById('pattern').value;
            let files = await eel.process_files(path, pattern)();
            if (files.length > 0) {
                printToConsole(`Found ${files.length} files matching '${pattern}':`);
                files.forEach(file => {
                    addFileToExplorer(file);
                });
            }
        }
        
    </script>
    </head>
    <body>
        <div class="header">
            <input type="text" id="path" placeholder="Enter directory path">
            <input type="text" id="pattern" placeholder="Enter search pattern">
            <button onclick="processFiles()">Process Files</button>
            <button onclick="updateIndex()">Update Index</button>
        </div>
        <div id="file-explorer" class="file-explorer">
            <table>
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Path</th>
                        <th>Size</th>
                        <th>Date Modified</th>
                    </tr>
                </thead>
                <tbody id="file-list">
                    <!-- File entries will be populated here -->
                </tbody>
            </table>
        </div>

        <!-- Log Section -->
        <div id="log" class="log">
            <!-- Log messages will be populated here -->
        </div>
    </body>
</html>
